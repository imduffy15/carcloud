<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">
    <property name="now" value="now()" dbms="mysql,h2"/>
    <property name="now" value="current_timestamp" dbms="postgresql"/>
    <changeSet author="duffy (generated)" id="dump1">
        <createTable tableName="hibernate_sequences">
            <column name="sequence_name" type="VARCHAR(255)"/>
            <column name="sequence_next_hi_value" type="INT"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump2">
        <createTable tableName="oauth_access_token">
            <column name="token_id" type="VARCHAR(255)"/>
            <column name="token" type="BLOB"/>
            <column name="authentication_id" type="VARCHAR(255)"/>
            <column name="user_name" type="VARCHAR(255)"/>
            <column name="client_id" type="VARCHAR(255)"/>
            <column name="authentication" type="BLOB"/>
            <column name="refresh_token" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump3">
        <createTable tableName="oauth_approvals">
            <column name="userid" type="VARCHAR(255)"/>
            <column name="clientid" type="VARCHAR(255)"/>
            <column name="scope" type="VARCHAR(255)"/>
            <column name="status" type="VARCHAR(255)"/>
            <column name="expiresat" type="TIMESTAMP"/>
            <column name="lastmodifiedat" type="TIMESTAMP"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump4">
        <createTable tableName="oauth_client_details">
            <column name="client_id" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="resource_ids" type="VARCHAR(255)"/>
            <column name="CLIENT_SECRET" type="VARCHAR(255)"/>
            <column name="scope" type="VARCHAR(255)"/>
            <column name="authorized_grant_types" type="VARCHAR(255)"/>
            <column name="web_server_redirect_uri" type="VARCHAR(255)"/>
            <column name="authorities" type="VARCHAR(255)"/>
            <column name="access_token_validity" type="INT"/>
            <column name="refresh_token_validity" type="INT"/>
            <column name="additional_information" type="VARCHAR(255)"/>
            <column name="autoapprove" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump5">
        <createTable tableName="oauth_client_token">
            <column name="token_id" type="VARCHAR(255)"/>
            <column name="token" type="BLOB"/>
            <column name="authentication_id" type="VARCHAR(255)"/>
            <column name="user_name" type="VARCHAR(255)"/>
            <column name="client_id" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump6">
        <createTable tableName="oauth_code">
            <column name="code" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump7">
        <createTable tableName="oauth_refresh_token">
            <column name="token_id" type="VARCHAR(255)"/>
            <column name="token" type="BLOB"/>
            <column name="authentication" type="BLOB"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump8">
        <createTable tableName="t_authority">
            <column name="name" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump9">
        <createTable tableName="t_device">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" type="VARCHAR(50)" defaultValue="system"/>
            <column name="created_date" type="timestamp" defaultValueDate="${now}"/>
            <column name="last_modified_by" type="VARCHAR(50)"/>
            <column name="last_modified_date" type="timestamp"/>
            <column name="version" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="VARCHAR(150)"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump10">
        <createTable tableName="t_device_owner">
            <column name="device_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="username" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump11">
        <createTable tableName="t_field_boolean">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)"/>
            <column name="value" type="BIT"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump12">
        <createTable tableName="t_field_integer">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)"/>
            <column name="value" type="INT"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump13">
        <createTable tableName="t_field_string">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)"/>
            <column name="value" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump14">
        <createTable tableName="t_track">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" type="VARCHAR(50)" defaultValue="system"/>
            <column name="created_date" type="timestamp" defaultValueDate="${now}"/>
            <column name="last_modified_by" type="VARCHAR(50)"/>
            <column name="last_modified_date" type="timestamp"/>
            <column name="version" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="latitude" type="DOUBLE"/>
            <column name="longitude" type="DOUBLE"/>
            <column name="received_at" type="timestamp"/>
            <column name="recorded_at" type="timestamp"/>
            <column name="device_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump15">
        <createTable tableName="t_track_fields">
            <column name="t_track" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="fields" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump16">
        <createTable tableName="t_user">
            <column name="username" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" type="VARCHAR(50)" defaultValue="system"/>
            <column name="created_date" type="timestamp" defaultValueDate="${now}"/>
            <column name="last_modified_by" type="VARCHAR(50)"/>
            <column name="last_modified_date" type="timestamp"/>
            <column name="version" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="email" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="first_name" type="VARCHAR(50)"/>
            <column name="last_name" type="VARCHAR(50)"/>
            <column name="password" type="VARCHAR(100)"/>
            <column name="phone" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump17">
        <createTable tableName="t_user_authority">
            <column name="username" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump18" context="prod">
        <addPrimaryKey columnNames="name" constraintName="PRIMARY" tableName="t_authority"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump19" context="prod">
        <addPrimaryKey columnNames="id" constraintName="PRIMARY" tableName="t_device"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump20" context="prod">
        <addPrimaryKey columnNames="id" constraintName="PRIMARY" tableName="t_field_boolean"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump21" context="prod">
        <addPrimaryKey columnNames="id" constraintName="PRIMARY" tableName="t_field_integer"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump22" context="prod">
        <addPrimaryKey columnNames="id" constraintName="PRIMARY" tableName="t_field_string"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump23" context="prod">
        <addPrimaryKey columnNames="id" constraintName="PRIMARY" tableName="t_track"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump24" context="prod">
        <addPrimaryKey columnNames="username" constraintName="PRIMARY" tableName="t_user"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump25">
        <addUniqueConstraint columnNames="email" constraintName="UK_i6qjjoe560mee5ajdg7v1o6mi" deferrable="false" disabled="false" initiallyDeferred="false" tableName="t_user"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump26">
        <addUniqueConstraint columnNames="phone" constraintName="UK_m5bu5erj83eubjsa1nyms0t89" deferrable="false" disabled="false" initiallyDeferred="false" tableName="t_user"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump27">
        <addForeignKeyConstraint baseColumnNames="username" baseTableName="t_device_owner" constraintName="FK_975c8qf6dgd3gcpjpm3sdu291" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="username" referencedTableName="t_user"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump28">
        <addForeignKeyConstraint baseColumnNames="username" baseTableName="t_user_authority" constraintName="FK_a0244t2n8jvn52m3ep4myilt1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="username" referencedTableName="t_user"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump29">
        <addForeignKeyConstraint baseColumnNames="device_id" baseTableName="t_track" constraintName="FK_cwnm9lpwcabuyi89h1qkuaavj" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="t_device"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump30">
        <addForeignKeyConstraint baseColumnNames="device_id" baseTableName="t_device_owner" constraintName="FK_ib7vnp2olk25703c5xwpshvdc" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="t_device"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump31">
        <addForeignKeyConstraint baseColumnNames="t_track" baseTableName="t_track_fields" constraintName="FK_kgirif8osovai9m5ub2tdg3x7" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="t_track"/>
    </changeSet>
    <changeSet author="duffy (generated)" id="dump32">
        <addForeignKeyConstraint baseColumnNames="name" baseTableName="t_user_authority" constraintName="FK_tghvo3hwad0ifdm39n7bph8b" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="name" referencedTableName="t_authority"/>
    </changeSet>
</databaseChangeLog>
